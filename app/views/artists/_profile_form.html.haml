#artist-profile-form
	- @artist = current_artist
	.name.form-block.single-input
		= form_for(@artist, remote: true, url: artist_profile_update_path) do |f|
			%span.label Artist Name
			= f.text_field :artist_name, class: 'text-box'
			= f.hidden_field :id, value: @artist.id
	
	.photo.form-block
		= form_for(@artist, remote: true, url: artist_profile_update_path) do |f|
			= f.hidden_field :id, value: @artist.id
			%span.label Your Artist Photo
			.sub-label This is how people will see you when they click on your artist name in the player.
			
			.photo-edit
				.content
				
					.upload-wrapper
						.preview{style: "background: url(#{@artist.artist_photo.url(:thumb)}) center no-repeat; background-size: 100%;"}
						= f.file_field :artist_photo, class: 'file-select overlay'

					.action-buttons

						.submit-wrapper
							.underlay
								%span browse
							= f.file_field :artist_photo, class: 'overlay'

						.submit-wrapper.disabled
							.underlay
								%span upload image
							= f.submit "upload image", class: 'overlay'
			
	.website.form-block.single-input

		= form_for(@artist, remote: true, url: artist_profile_update_path) do |f|
			- @genre_tags = @artist.genre_tags.nil? ? [] : @artist.genre_tags
			= f.hidden_field :id, value: @artist.id

			%span.label Website
			= f.text_field :website, class: 'text-box'
			
	.artist-tags.form-block
		= form_for(@artist, remote: true, url: artist_profile_update_path) do |f|
			- @genre_tags = @artist.genre_tags.nil? ? [] : @artist.genre_tags
			= f.hidden_field :id, value: @artist.id

			.sub-label Include tags so fans can discover you, eg: "metal", "indie", "toronto", "experimental"
			.tag-form= f.text_area :genre_tags, value: @genre_tags.join(','), id: 'artist-genre-tags'

:javascript
	$(document).ajaxStart(function() {
		$('.modal#artist-profile .spinner').show();
	});

	$(document).ajaxStop(function() {
		$('.modal#artist-profile .spinner').hide();
	});

	$('#artist-profile-form form').children('input[type=text], textarea').typing({
		stop: function(event, $elem) {
			$elem.closest('form').submit();
		},
		delay: 400
	});

	$('#artist-genre-tags').tagsInput({
		'defaultText': 'add more tags...',
		'height': '150px',
		'width': '284px',
		'onAddTag': function() {
			console.log(this.id);
			$(this).closest('form').submit();
		},
		'onRemoveTag': function() {
			$(this).closest('form').submit();
		}
	});

	$('#artist-profile-form .photo-edit input[type="submit"]').click(function(e) {
		if($(this).closest('.submit-wrapper').hasClass('disabled')) {
			e.preventDefault();
		}
	});
	
	$('#artist-profile-form .photo-edit input[type="file"]').on('change', function() {
		readURL(this);
	});
	
	function readURL(input) {
		if(input.files && input.files[0]) {
			var reader = new FileReader();
			reader.onload = function(e) {
				$('#artist-profile-form .photo-edit .preview').css('background-image', 'url(' + e.target.result + ')');
			}
			
			reader.readAsDataURL(input.files[0]);
			$('#artist-profile-form .photo-edit input[type="submit"]').closest('.submit-wrapper').removeClass('disabled');
		}
	
	}
