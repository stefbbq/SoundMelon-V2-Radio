#meta-panel
	%a#meta-back BACK

	- @user = current_user
	- @user_meta = @user.user_meta.nil? ? [] : @user.user_meta
	= form_for(@user, remote: true, url: update_user_meta_path) do |f|
		= f.hidden_field :id, value: @user.id

		= f.label :city, ""
		= f.text_field :city, placeholder: "Your City"
		= f.hidden_field :custom_city, value: false

		= f.label :user_meta, "Your Custom Tags"
		= f.text_area :user_meta, value: @user_meta.join(', '), placeholder: 'Eg. "ambient", "indie", "local"', id: "user-meta-tags"

	%a#show-fb-meta View your Facebook computed tags!
	#fb-meta-panel
		= link_to "Reload Facebook Tags", reload_fb_meta_path(id: current_user.id), remote: true, class: 'hover-link'
		#fb-meta-form
			= render 'users/fb_meta_form'

:javascript
	$('#user-meta-tags').tagsInput({
		'removeWithBackspace': false,
		'defaultText': 'Add genres Eg. "ambient, fusion rap, rock \'n roll"',
		'height': '200px',
		'width': 'auto',
		'onAddTag': function() {
			console.log(this.id);
			$(this).parent('form').submit();
		},
		'onRemoveTag': function() {
			console.log($(this).parent('form'));
			$(this).parent('form').submit();
		}
	});

	$('#meta-back').click(function() {
		$('#settings-panel').show();
		$('#meta-panel').remove();
	});

	$('#show-fb-meta').click(function() {
		$('#fb-meta-panel').slideToggle();
	});


